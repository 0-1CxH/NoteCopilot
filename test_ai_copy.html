<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Copy Button Test</title>
    <style>
        /* Basic styles for AI components */
        ai-message-component-think {
            display: block;
            padding: 20px;
            margin: 20px 0;
            background: rgba(255, 237, 213, 0.7);
            border: 4px solid rgba(249, 115, 22, 0.3);
            border-radius: 6px;
            position: relative;
        }
        
        ai-message-component-response {
            display: block;
            padding: 20px;
            margin: 20px 0;
            background: rgba(250, 250, 255, 0.5);
            border: 4px solid rgba(249, 115, 22, 0.3);
            border-radius: 6px;
            position: relative;
        }
        
        .copy-btn {
            position: absolute;
            top: 8px;
            left: 8px;
            z-index: 100000;
            display: none;
            padding: 4px 10px;
            font-size: 0.95em;
            background: rgba(59, 130, 246, 0.6);
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            box-shadow: 0 2px 8px 0 rgba(99,102,241,0.13);
            transition: background 0.2s;
        }
        
        .copy-btn:hover {
            background: rgba(37, 99, 235, 0.8);
        }
    </style>
</head>
<body>
    <h1>AI Copy Button Test</h1>
    
    <ai-message-component-think data-original-content="# Think Component

This is a **bold** paragraph with `inline code` in the think component.

- List item 1
- List item 2
  - Nested item
- List item 3

> This is a blockquote in the think component.

| Think | Table | Test |
|-------|-------|------|
| Data 1 | Data 2 | Data 3 |

```python
def think_function():
    return \"This is code in think component\"
```">
        <h1>Think Component</h1>
        <p>This is a <strong>bold</strong> paragraph with <code>inline code</code> in the think component.</p>
        <ul>
            <li>List item 1</li>
            <li>List item 2
                <ul>
                    <li>Nested item</li>
                </ul>
            </li>
            <li>List item 3</li>
        </ul>
        <blockquote>
            <p>This is a blockquote in the think component.</p>
        </blockquote>
        <table>
            <thead>
                <tr>
                    <th>Think</th>
                    <th>Table</th>
                    <th>Test</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Data 1</td>
                    <td>Data 2</td>
                    <td>Data 3</td>
                </tr>
            </tbody>
        </table>
        <pre><code>def think_function():
    return "This is code in think component"</code></pre>
    </ai-message-component-think>
    
    <ai-message-component-response data-original-content="# Response Component

This is a **bold** paragraph with `inline code` in the response component.

- List item 1
- List item 2
  - Nested item
- List item 3

> This is a blockquote in the response component.

| Response | Table | Test |
|----------|-------|------|
| Data 1 | Data 2 | Data 3 |

```javascript
function responseFunction() {
    return \"This is code in response component\";
}
```">
        <h1>Response Component</h1>
        <p>This is a <strong>bold</strong> paragraph with <code>inline code</code> in the response component.</p>
        <ul>
            <li>List item 1</li>
            <li>List item 2
                <ul>
                    <li>Nested item</li>
                </ul>
            </li>
            <li>List item 3</li>
        </ul>
        <blockquote>
            <p>This is a blockquote in the response component.</p>
        </blockquote>
        <table>
            <thead>
                <tr>
                    <th>Response</th>
                    <th>Table</th>
                    <th>Test</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Data 1</td>
                    <td>Data 2</td>
                    <td>Data 3</td>
                </tr>
            </tbody>
        </table>
        <pre><code>function responseFunction() {
    return "This is code in response component";
}</code></pre>
    </ai-message-component-response>
    
    <script>
        // Copy button functionality
        function addCopyButtons() {
            function createCopyBtn() {
                const btn = document.createElement('button');
                btn.className = 'copy-btn';
                btn.innerHTML = 'COPY';
                btn.style.position = 'absolute';
                btn.style.top = '8px';
                btn.style.left = '8px';
                btn.style.zIndex = '100000';
                btn.style.display = 'none';
                btn.style.padding = '4px 10px';
                btn.style.fontSize = '0.95em';
                btn.style.background = 'rgba(59, 130, 246, 0.6)';
                btn.style.color = '#fff';
                btn.style.border = 'none';
                btn.style.borderRadius = '6px';
                btn.style.cursor = 'pointer';
                btn.style.boxShadow = '0 2px 8px 0 rgba(99,102,241,0.13)';
                btn.style.transition = 'background 0.2s';
                btn.addEventListener('mouseenter', () => btn.style.background = 'rgba(37, 99, 235, 0.8)');
                btn.addEventListener('mouseleave', () => btn.style.background = 'rgba(59, 130, 246, 0.6)');
                return btn;
            }

            const selectors = [
                'ai-message-component-think',
                'ai-message-component-response'
            ];
            
            console.log('Adding copy buttons...');
            let totalElements = 0;
            
            selectors.forEach(sel => {
                const elements = document.querySelectorAll(sel);
                console.log(`Selector "${sel}" found ${elements.length} elements`);
                
                elements.forEach(block => {
                    totalElements++;
                    console.log(`Processing ${sel} element:`, block);
                    
                    // Make sure the block is relatively positioned
                    block.style.position = 'relative';
                    // Add transition for smooth box-shadow animation
                    block.style.transition = 'box-shadow 0.3s ease';
                    // Only add one button per block
                    if (block.querySelector('.copy-btn')) {
                        console.log('Copy button already exists, skipping');
                        return;
                    }
                    const btn = createCopyBtn();
                    block.appendChild(btn);
                    console.log(`Added copy button to ${sel} element`);
                    
                    block.addEventListener('mouseenter', () => {
                        btn.style.display = 'block';
                        block.style.boxShadow = '0 0 20px rgba(59, 130, 246, 0.3)';
                    });
                    block.addEventListener('mouseleave', () => {
                        btn.style.display = 'none';
                        block.style.boxShadow = '';
                    });
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        let text = '';
                        if (block.matches('ai-message-component-think') || block.matches('ai-message-component-response')) {
                            text = block.getAttribute('data-original-content') || block.innerText;
                            console.log('Copying AI component text:', text.substring(0, 100) + '...');
                        }
                        navigator.clipboard.writeText(text);
                        btn.innerHTML = 'COPIED!';
                        setTimeout(() => { btn.innerHTML = 'COPY'; }, 1200);
                    });
                });
            });
            
            console.log(`Total elements processed: ${totalElements}`);
        }

        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM Content Loaded - adding copy buttons');
            addCopyButtons();
        });
    </script>
</body>
</html> 